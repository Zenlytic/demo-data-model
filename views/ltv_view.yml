version: 1
type: view
name: ltv
model_name: pure_organics
sql_table_name: DEMO_PROD.LTV
default_date: date_month
fields:
  - name: customer_id
    field_type: dimension
    type: number
    sql: ${TABLE}."CUSTOMER_ID"
  - name: n_customers_in_month
    field_type: dimension
    type: number
    sql: ${TABLE}."N_CUSTOMERS_IN_MONTH"
  - name: n_orders_in_month
    field_type: dimension
    type: number
    sql: ${TABLE}."N_ORDERS_IN_MONTH"
  - name: n_cumulative_orders
    field_type: dimension
    type: number
    sql: ${TABLE}."N_CUMULATIVE_ORDERS"
  - name: gross_sales
    field_type: dimension
    type: number
    sql: ${TABLE}."GROSS_SALES"
  - name: date_month
    field_type: dimension_group
    type: time
    datatype: date
    timeframes:
      - raw
      - date
      - day_of_year
      - week
      - week_of_year
      - month
      - month_of_year
      - quarter
      - year
    sql: ${TABLE}."DATE_MONTH"
