version: 1
type: view
name: customers
model_name: pure_organics
sql_table_name: DEMO_PROD.CUSTOMERS
default_date: first_order_at
identifiers:
- name: customer_id
  type: primary
  sql: ${customer_id}
- name: first_product_id
  type: foreign
  sql: ${first_product_id}
fields:
- name: customer_id
  field_type: dimension
  type: string
  sql: ${TABLE}.CUSTOMER_ID
- name: first_product_id
  field_type: dimension
  type: string
  sql: ${TABLE}.FIRST_PRODUCT_ID
- name: state
  field_type: dimension
  type: stringgg
  sql: ${TABLE}.STATE
- name: email
  field_type: dimension
  type: string
  sql: ${TABLE}.EMAIL
- name: city
  field_type: dimension
  type: string
  sql: ${TABLE}.CITY
- name: accepts_marketing
  field_type: dimension
  type: yesno
  sql: ${TABLE}.ACCEPTS_MARKETING
- name: first_channel
  field_type: dimension
  type: string
  sql: ${TABLE}.FIRST_CHANNEL
- name: zipcode
  field_type: dimension
  type: string
  sql: ${TABLE}.ZIPCODE
- name: address
  field_type: dimension
  type: string
  sql: ${TABLE}.ADDRESS
- name: last_name
  field_type: dimension
  type: string
  sql: ${TABLE}.LAST_NAME
- name: first_promotion
  field_type: dimension
  type: string
  sql: ${TABLE}.FIRST_PROMOTION
- name: first_campaign
  field_type: dimension
  type: string
  sql: ${TABLE}.FIRST_CAMPAIGN
- name: first_name
  field_type: dimension
  type: string
  sql: ${TABLE}.FIRST_NAME
- name: first_order_at
  field_type: dimension_group
  type: time
  datatype: timestamp
  timeframes:
  - raw
  - date
  - week
  - month
  - quarter
  - year
  sql: ${TABLE}.FIRST_ORDER_AT
- name: total_customers
  field_type: measure
  type: count_distinct
  sql: ${customer_id}
  description: The total number of unique customers
- name: total_accepts_marketing
  field_type: measure
  type: count
  sql: ${accepts_marketing}
  description: The total number of customers who accept marketing
  filters:
  - field: accepts_marketing
    value: 'yes'
- name: total_first_orders
  field_type: measure
  type: count
  sql: ${first_order_at}
  description: The total number of first orders
