version: 1
type: view
name: customers
model_name: pure_organics
sql_table_name: DEMO_PROD.CUSTOMERS
default_date: first_order_at
identifiers:
  - name: customer_id
    type: primary
    sql: ${customer_id}
fields:
  - name: first_product_id
    field_type: dimension
    type: string
    sql: ${TABLE}.FIRST_PRODUCT_ID
  - name: customer_id
    field_type: dimension
    type: string
    sql: ${TABLE}.CUSTOMER_ID
  - name: zipcode
    field_type: dimension
    type: string
    sql: ${TABLE}.ZIPCODE
  - name: first_promotion
    field_type: dimension
    type: string
    sql: ${TABLE}.FIRST_PROMOTION
    label: Second Promo
  - name: accepts_marketing
    field_type: dimension
    type: yesno
    sql: ${TABLE}.ACCEPTS_MARKETING
  - name: first_campaign
    field_type: dimension
    type: string
    sql: ${TABLE}.FIRST_CAMPAIGN
  - name: last_name
    field_type: dimension
    type: string
    sql: ${TABLE}.LAST_NAME
  - name: city
    field_type: dimension
    type: string
    sql: ${TABLE}.CITY
  - name: first_channel
    field_type: dimension
    type: string
    sql: ${TABLE}.FIRST_CHANNEL
  - name: address
    field_type: dimension
    type: string
    sql: ${TABLE}.ADDRESS
  - name: first_name
    field_type: dimension
    type: string
    sql: ${TABLE}.FIRST_NAME
  - name: state
    field_type: dimension
    type: string
    sql: ${TABLE}.STATE
  - name: email
    field_type: dimension
    type: string
    sql: ${TABLE}.EMAIL
  - name: first_order_at
    field_type: dimension_group
    type: time
    datatype: timestamp
    timeframes:
      - raw
      - date
      - week
      - month
      - quarter
      - year
    sql: ${TABLE}.FIRST_ORDER_AT
  - name: count_unique_customers
    field_type: measure
    type: count_distinct
    description: The unique number of customers in the dataset.
    sql: ${customer_id}
  - name: marketing_acceptance_rate
    field_type: measure
    type: average
    description: The percentage of customers who have accepted marketing
    sql: CASE WHEN ${accepts_marketing} = 'yes' THEN 1 ELSE 0 END
  - name: number_of_first_promotions
    field_type: measure
    type: count_distinct
    description: The count of different first promotions that customers received.
    sql: ${first_promotion}
  - name: number_of_first_campaigns
    field_type: measure
    type: count_distinct
    description: The count of different first campaigns that customers were part of.
    sql: ${first_campaign}
  - name: number_of_first_channels
    field_type: measure
    type: count_distinct
    description: The count of different first channels that customers used.
    sql: ${first_channel}
  - name: customer_count_by_zipcode
    field_type: measure
    type: count
    description: The number of customers by zipcode.
    sql: COUNT(DISTINCT ${customer_id})
  - name: customer_count_by_city
    field_type: measure
    type: count
    description: The number of customers by city.
    sql: COUNT(DISTINCT ${customer_id})
  - name: customer_count_by_state
    field_type: measure
    type: count
    description: The number of customers by state.
    sql: COUNT(DISTINCT ${customer_id})
  - name: first_product_acquirement_count
    field_type: measure
    type: count_distinct
    description: The count of unique first products acquired by customers.
    sql: ${first_product_id}
