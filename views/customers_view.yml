version: 1
type: view
name: customers
model_name: pure_organics
sql_table_name: DEMO_PROD.CUSTOMERS
default_date: first_order
row_label: Customer
identifiers:
- name: customer_id
  type: primary
  sql: ${customer_id}
fields:
- name: customer_id
  field_type: dimension
  type: string
  hidden: true
  primary_key: true
  sql: ${TABLE}.CUSTOMER_ID

- name: accepts_marketing
  field_type: dimension
  type: yesno
  sql: ${TABLE}.ACCEPTS_MARKETING

- name: email
  field_type: dimension
  type: string
  description: The customer's email address
  required_access_grants:
  - pii_access
  sql: ${TABLE}.EMAIL

- name: first_name
  field_type: dimension
  type: string
  sql: ${TABLE}.FIRST_NAME

- name: last_name
  field_type: dimension
  type: string
  sql: ${TABLE}.LAST_NAME

- name: address
  field_type: dimension
  type: string
  description: The customer's address (shipping)
  sql: ${TABLE}.ADDRESS

- name: city
  field_type: dimension
  type: string
  description: The customer's city (location)
  sql: ${TABLE}.CITY
  drill_up: state
  drill_down: zipcode

- name: state
  field_type: dimension
  type: string
  description: The customer's state (location)
  sql: ${TABLE}.STATE
  searchable: true
  drill_down: city

- name: zipcode
  field_type: dimension
  type: string
  description: The customer's zip code
  sql: ${TABLE}.ZIPCODE
  drill_up: city

- name: first_marketing_group
  field_type: dimension
  type: string
  description: The first marketing group the user came in through
  sql: ${TABLE}.first_channel

- name: first_promotion
  field_type: dimension
  type: string
  description: The first promotion the user came in through
  sql: ${TABLE}.first_promotion

- name: first_campaign
  field_type: dimension
  type: string
  description: The first campaign the user came in through
  sql: ${TABLE}.first_campaign

- name: first_order
  field_type: dimension_group
  type: time
  datatype: timestamp
  description: The time at which the customer's first order was placed.
  timeframes:
  - raw
  - date
  - week_index
  - week
  - month_of_year
  - month
  - quarter
  - year
  sql: ${TABLE}.first_order_at
  
- name: NON_JOINABLE_TEST
  field_type: measure
  type: number
  sql: SUM(${marketing_spend.ad_spend})/NULLIF(${order_lines.number_of_new_customers_with_orders},
    0)
  is_merged_result: yes

    