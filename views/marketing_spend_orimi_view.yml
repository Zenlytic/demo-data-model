version: 1
type: view
name: marketing_spend_orimi
model_name: pure_organics
default_date: spend_at
sql_table_name: DEMO.DEMO_PROD.MARKETING_SPEND_ORIMI
fields:
  - name: spend_id
    field_type: dimension
    type: yesno
    sql: ${TABLE}.SPEND_ID
    primary_key: true
    hidden: true
  - name: source
    field_type: dimension
    type: string
    sql: ${TABLE}.SOURCE
  - name: campaign
    field_type: dimension
    type: string
    sql: ${TABLE}.CAMPAIGN
  - name: ad_spend
    field_type: dimension
    type: number
    sql: ${TABLE}.AD_SPEND
  - name: channel
    field_type: dimension
    type: string
    sql: ${TABLE}.CHANNEL
  - name: spend_at
    field_type: dimension_group
    type: time
    datatype: timestamp
    timeframes:
      - raw
      - date
      - week
      - month
      - quarter
      - year
    sql: ${TABLE}.SPEND_AT
  - name: total_ad_spend
    field_type: measure
    type: sum
    sql: ${ad_spend}
    description: The total amount spent on advertising across all channels and campaigns.
  - name: average_ad_spend
    field_type: measure
    type: average
    sql: ${ad_spend}
    description: The average amount spent on advertising per campaign or channel.
  - name: count_campaigns
    field_type: measure
    type: count_distinct
    sql: ${campaign}
    description: The total number of unique campaigns.
  - name: count_channels
    field_type: measure
    type: count_distinct
    sql: ${channel}
    description: The total number of unique channels used for advertising.
  - name: count_sources
    field_type: measure
    type: count_distinct
    sql: ${source}
    description: >-
      The total number of unique sources from which the ad spend data is
      collected.
identifiers:
  - name: spend_id
    type: primary
    sql: ${spend_id}
