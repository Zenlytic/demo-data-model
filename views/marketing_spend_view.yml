version: 1
type: view
name: marketing_spend
description: A view for marketing spend.
model_name: pure_organics
sql_table_name: DEMO_PROD.MARKETING_SPEND
default_date: spend
row_label: Spend Item
fields:
  - name: total_marketing_spend
    field_type: measure
    type: sum
    description: Total marketing spend across all channels
    value_format_name: usd
    sql: ${ad_spend}
    label: ''
    hidden: false
    searchable: null
    synonyms: []
    non_additive_dimension:
      name: hello
      window_aware_of_query_dimensions: false
      window_choice: ''
      window_groupings: []
  - name: cac
    field_type: measure
    type: number
    label: CaC
    description: >-
      Cost of acquisition = Total marketing spend across all channels / number
      of new customers who placed orders in that period
    value_format_name: usd
    sql: >-
      ${total_marketing_spend} /
      nullif(${order_lines.number_of_new_customers_with_orders}, 0)
    is_merged_result: true
    hidden: false
    searchable: null
    synonyms: []
  - name: cpc
    field_type: measure
    type: number
    label: CPC
    description: >-
      Cost oer click = Total marketing spend across all channels / number of
      clicks through ads
    value_format_name: usd
    sql: ${total_marketing_spend} / 1304000
    hidden: false
    searchable: null
    synonyms: []
  - name: roas
    field_type: measure
    type: number
    label: ROAS
    description: >-
      Return on advertising spend = Total advertising revenue / Total marketing
      spend across all channels
    value_format_name: decimal_1
    sql: >-
      ${order_lines.total_gross_revenue_from_advertising} /
      nullif(${total_marketing_spend}, 0)
    is_merged_result: true
    hidden: false
    searchable: null
    synonyms: []
  - name: proas
    field_type: measure
    type: number
    label: PROAS
    description: >-
      Profitable return on advertising spend = Total advertising gross profit /
      Total marketing spend across all channels
    value_format_name: decimal_1
    sql: ${order_lines.gross_profit} / nullif(${total_marketing_spend}, 0)
    is_merged_result: true
    hidden: false
    searchable: null
    synonyms: []
