version: 1
type: view
name: marketing_spend
model_name: pure_organics
sql_table_name: DEMO_PROD.MARKETING_SPEND
default_date: spend_at
identifiers:
- name: spend_id
  type: primary
  sql: ${spend_id}
fields:
- name: spend_id
  field_type: dimension
  type: string
  sql: ${TABLE}.SPEND_ID
  primary_key: 'yes'
- name: ad_spend
  field_type: dimension
  type: number
  sql: ${TABLE}.AD_SPEND
- name: source
  field_type: dimension
  type: string
  sql: ${TABLE}.SOURCE
- name: campaign
  field_type: dimension
  type: string
  sql: ${TABLE}.CAMPAIGN
- name: channel
  field_type: dimension
  type: string
  sql: ${TABLE}.CHANNEL
- name: spend_at
  field_type: dimension_group
  type: time
  datatype: timestamp
  timeframes:
  - raw
  - date
  - week
  - month
  - quarter
  - year
  sql: ${TABLE}.SPEND_AT
- name: total_ad_spend
  field_type: measure
  type: sum
  sql: ${ad_spend}
  description: The total amount spent on ads
- name: average_ad_spend
  field_type: measure
  type: average
  sql: ${ad_spend}
  description: The average amount spent on ads
- name: number_of_campaigns
  field_type: measure
  type: count_distinct
  sql: ${campaign}
  description: The number of distinct campaigns
- name: number_of_channels
  field_type: measure
  type: count_distinct
  sql: ${channel}
  description: The number of distinct channels
