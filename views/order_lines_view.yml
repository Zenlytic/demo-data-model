version: 1
type: view
name: order_lines
model_name: pure_organics
sql_table_name: DEMO_PROD.ORDER_LINES
default_date: order_at
identifiers:
- name: order_line_id
  type: primary
  sql: ${order_line_id}
- name: customer_id
  type: foreign
  sql: ${customer_id}
fields:
- name: product_id
  field_type: dimension
  type: string
  sql: ${TABLE}.PRODUCT_ID
- name: order_id
  field_type: dimension
  type: string
  sql: ${TABLE}.ORDER_ID
- name: order_line_id
  field_type: dimension
  type: string
  sql: ${TABLE}.ORDER_LINE_ID
- name: customer_id
  field_type: dimension
  type: string
  sql: ${TABLE}.CUSTOMER_ID
- name: marketing_channel
  field_type: dimension
  type: string
  sql: ${TABLE}.MARKETING_CHANNEL
- name: order_number
  field_type: dimension
  type: string
  sql: ${TABLE}.ORDER_NUMBER
- name: marketing_source
  field_type: dimension
  type: string
  sql: ${TABLE}.MARKETING_SOURCE
- name: campaign
  field_type: dimension
  type: string
  sql: ${TABLE}.CAMPAIGN
- name: promotion
  field_type: dimension
  type: string
  sql: ${TABLE}.PROMOTION
- name: last_click
  field_type: dimension
  type: string
  sql: ${TABLE}.LAST_CLICK
- name: quantity
  field_type: dimension
  type: string
  sql: ${TABLE}.QUANTITY
- name: revenue
  field_type: dimension
  type: string
  sql: ${TABLE}.REVENUE
- name: price
  field_type: dimension
  type: string
  sql: ${TABLE}.PRICE
- name: subscription_vs_otp
  field_type: dimension
  type: string
  sql: ${TABLE}.SUBSCRIPTION_VS_OTP
- name: discount
  field_type: dimension
  type: string
  sql: ${TABLE}.DISCOUNT
- name: cogs
  field_type: dimension
  type: string
  sql: ${TABLE}.COGS
- name: first_click
  field_type: dimension
  type: string
  sql: ${TABLE}.FIRST_CLICK
- name: new_vs_repeat
  field_type: dimension
  type: string
  sql: ${TABLE}.NEW_VS_REPEAT
- name: order_at
  field_type: dimension_group
  type: time
  datatype: timestamp
  timeframes:
  - raw
  - date
  - week
  - month
  - quarter
  - year
  sql: ${TABLE}.ORDER_AT
- name: total_revenue
  field_type: measure
  type: sum
  sql: ${revenue}
  description: The total revenue generated from all orders
- name: average_price
  field_type: measure
  type: average
  sql: ${price}
  description: The average price of all products sold
- name: total_discount
  field_type: measure
  type: sum
  sql: ${discount}
  description: The total discount given on all orders
- name: total_quantity
  field_type: measure
  type: sum
  sql: ${quantity}
  description: The total quantity of products sold
- name: total_cogs
  field_type: measure
  type: sum
  sql: ${cogs}
  description: The total cost of goods sold
- name: number_of_orders
  field_type: measure
  type: count_distinct
  sql: ${order_id}
  description: The total number of orders placed
- name: number_of_customers
  field_type: measure
  type: count_distinct
  sql: ${customer_id}
  description: The total number of unique customers who placed orders
