version: 1
type: view
name: order_lines
model_name: base_model
sql_table_name: DEMO_RAW.ORDER_LINES
default_date: order_at
row_label: Order line

fields_for_analysis:
- subscription_vs_otp
- marketing_source
- marketing_channel
- promotion
- campaign
- products.product_title

identifiers:
- name: product_id
  type: foreign
  sql: ${product_id}
- name: customer_id
  type: foreign
  sql: ${customer_id}

fields:
- name: order_line_id
  field_type: dimension
  type: string
  sql: ${TABLE}.ORDER_LINE_ID
  primary_key: yes
  hidden: yes

- name: customer_id
  field_type: dimension
  type: string
  sql: ${TABLE}.CUSTOMER_ID
  hidden: yes

- name: order_id
  field_type: dimension
  type: string
  sql: ${TABLE}.ORDER_ID
  hidden: yes

- name: product_id
  field_type: dimension
  type: string
  sql: ${TABLE}.PRODUCT_ID
  hidden: yes

- name: discount
  field_type: dimension
  type: number
  sql: ${TABLE}.DISCOUNT
  hidden: yes

- name: revenue
  field_type: dimension
  type: number
  sql: ${TABLE}.REVENUE
  hidden: yes

- name: price
  field_type: dimension
  type: number
  sql: ${TABLE}.PRICE
  hidden: yes

- name: quantity
  field_type: dimension
  type: number
  sql: ${TABLE}.QUANTITY
  hidden: yes

- name: campaign
  field_type: dimension
  type: string
  sql: ${TABLE}.CAMPAIGN

- name: promotion
  field_type: dimension
  type: string
  sql: ${TABLE}.PROMOTION

- name: subscription_vs_otp
  field_type: dimension
  type: string
  sql: ${TABLE}.SUBSCRIPTION_VS_OTP

- name: marketing_source
  field_type: dimension
  type: string
  sql: ${TABLE}.MARKETING_SOURCE

- name: marketing_channel
  field_type: dimension
  type: string
  sql: ${TABLE}.MARKETING_CHANNEL

- name: order_at
  field_type: dimension_group
  type: time
  datatype: timestamp
  timeframes:
  - raw
  - date
  - week
  - month
  - quarter
  - year
  sql: ${TABLE}.ORDER_AT

- name: total_gross_revenue
  field_type: measure
  type: sum
  sql: ${revenue}
  description: "Total gross revenue = revenue from product sales + shipping revenues"
  value_format_name: usd
  extra:
    zenlytic.show: yes

- name: subscription_revenue
  field_type: measure
  type: sum
  sql: ${revenue}
  description: "Subscription revenue = revenue from product sales + shipping revenues (for subscriptions only)"
  value_format_name: usd
  filters:
  - field: subscription_vs_otp
    value: Subscription
  extra:
    zenlytic.show: yes